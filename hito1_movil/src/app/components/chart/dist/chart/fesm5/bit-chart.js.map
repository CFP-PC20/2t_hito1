{"version":3,"file":"bit-chart.js","sources":["ng://@bit/primefaces.primeng.chart/chart.ts"],"sourcesContent":["import {NgModule,Component,ElementRef,AfterViewInit,OnDestroy,Input,Output,EventEmitter} from '@angular/core';\nimport {CommonModule} from '@angular/common';\nimport * as Chart from 'chart.js';\n\n@Component({\n    selector: 'p-chart',\n    template: `\n        <div style=\"position:relative\" [style.width]=\"responsive && !width ? null : width\" [style.height]=\"responsive && !height ? null : height\">\n            <canvas [attr.width]=\"responsive && !width ? null : width\" [attr.height]=\"responsive && !height ? null : height\" (click)=\"onCanvasClick($event)\"></canvas>\n        </div>\n    `\n})\nexport class UIChart implements AfterViewInit, OnDestroy {\n\n    @Input() type: string;\n\n    @Input() options: any = {};\n\n    @Input() plugins: any[] = [];\n    \n    @Input() width: string;\n    \n    @Input() height: string;\n\n    @Input() responsive: boolean = true;\n    \n    @Output() onDataSelect: EventEmitter<any> = new EventEmitter();\n\n    initialized: boolean;\n    \n    _data: any;\n\n    chart: any;\n\n    constructor(public el: ElementRef) {}\n    \n    @Input() get data(): any {\n        return this._data;\n    }\n\n    set data(val:any) {\n        this._data = val;\n        this.reinit();\n    }\n\n    ngAfterViewInit() {\n        this.initChart();\n        this.initialized = true;\n    }\n\n    onCanvasClick(event) {\n        if(this.chart) {\n            let element = this.chart.getElementAtEvent(event);\n            let dataset = this.chart.getDatasetAtEvent(event);\n            if(element&&element[0]&&dataset) {\n                this.onDataSelect.emit({originalEvent: event, element: element[0], dataset: dataset});\n            }\n        }\n    }\n\n    initChart() {\n        let opts = this.options||{};\n        opts.responsive = this.responsive;\n\n        // allows chart to resize in responsive mode\n        if (opts.responsive&&(this.height||this.width)) {\n            opts.maintainAspectRatio = false;\n        }\n        //@ts-ignore\n        this.chart = new Chart(this.el.nativeElement.children[0].children[0], {\n            type: this.type,\n            data: this.data,\n            options: this.options,\n            plugins: this.plugins\n        });\n    }\n    \n    getCanvas() {\n        return this.el.nativeElement.children[0].children[0];\n    }\n    \n    getBase64Image() {\n        return this.chart.toBase64Image();\n    }\n    \n    generateLegend() {\n        if(this.chart) {\n            return this.chart.generateLegend();\n        }\n    }\n    \n    refresh() {\n        if(this.chart) {\n            this.chart.update();\n        }\n    }\n    \n    reinit() {\n        if(this.chart) {\n            this.chart.destroy();\n            this.initChart();\n        }\n    }\n    \n    ngOnDestroy() {\n        if(this.chart) {\n            this.chart.destroy();\n            this.initialized = false;\n            this.chart = null;\n        }\n    }\n}\n\n@NgModule({\n    imports: [CommonModule],\n    exports: [UIChart],\n    declarations: [UIChart]\n})\nexport class ChartModule { }\n"],"names":[],"mappings":"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"}